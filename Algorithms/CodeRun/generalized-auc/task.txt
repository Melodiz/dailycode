Обобщённый AUC // CodeRun

Классический ROC-AUC равен:
(1 / (N_0 * N_1)) * (Σ(i,j: t_i = 1 and t_j = 0) ([y_i > y_j] + 1/2 [y_i == y_j]))

Рассмотрим обобщённый AUC, который определён не только для бинарных ответов:
(Σ(i,j: t_i > t_j) ([y_i > y_j] + 1/2 [y_i == y_j])) / |{i, j: t_i > t_j}|

Даны массив правильных ответов и массив предсказаний модели.

Необходимо посчитать обобщённый AUC.

Формат ввода

В первой строке указано одно число $N$ — число объектов в выборке ($2 \leqslant N \leqslant 100000$).

В каждой из следующих $N$ строк содержится два числа $t_i$ и $p_i$ (с точностью не более 6 цифр после десятичной точки): правильный ответ примера и предсказание модели для этого примера.

Гарантируется, что существуют два таких номера $i$ и $j$, что $t_i \ne t_j$.

Формат вывода

Выведите одно число (значение обобщённого AUC) с точностью как минимум 6 значащих цифр после десятичной точки.

Примечание

Гарантируется, что все закрытые тесты соответствуют одному из трех наборов ограничений:

1) \( n \leq 10 \); \( 0 \leq t_i, y_i \leq 10 \); \( t_i, y_i \) целые числа;
2) \( n = 1000 \); \( 0 \leq t_i, y_i \leq 10 \); \( t_i, y_i \) целые числа;
3) \( n = 10^5 \); \( 0 \leq t_i, y_i \leq 1 \); \( t_i, y_i \) вещественные числа, не более 6 знаков после запятой.

Гарантируется, что все \( t_i, y_i \) сгенерированы случайно с равномерным распределением в отрезке \([0;1]\).